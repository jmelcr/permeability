# *In silico* investigation of the permeability of small polar solutes through lipid membranes at various phases

Repository supporting the *in silico* part of the research.

## What does this repository contain?

### Simulations settings, initial configurations and extra topologies
This repository contains the **files required to run the simulations** for this project. 
This includes several initial starting configurations of the membrane systems,
simulation setup "mdp" files
as well as 
extra topology files for any specialized molecules used in the project 
(e.g. an array of permeating solutes of varying hydrophobicity 
located in the [the top folder](top/martini_v3.0_solvents.itp))

MDP files contain simulations settings 
for the use with GROMACS molecular simulation software; 
[MDP file example](simulations/martini_3_awh-md_293K.mdp)

Initial configurations are in the GROMACS "gro" format
and are located in folders named `prep_min_eq` 
in each respective membrane composition;
e.g. [here](simulations/cholesterol45p_PC_variousTails_sims/prep_min_eq/long_eq)
 the initial configuration for the simulation of DPPC with 45% cholesterol

Installation of the required software and 
using the scripts to perform the simulations
requires a subtantial practical knowledge of 
Molecular Dynamics simulations,
and may require several hours 
on sufficient computational resources to run. 

### Analysis scripts of the simulation trajectories
I have also included the **analysis scripts of the simulation trajectories**
In order to reproduce the simulations,
it is necessarry to have a working installation of the GROMACS software (v2019.1 or higher)
and a sufficient computational resources to calculate the trajectories. 
The analysis scripts use the built-in GROMACS tools to analyze the simulation trajectories,
and they are written in BASH.
In order to successfuly run the simulations and analysis, 
some adaptations specific to the running conditions are needed 
(e.g. changing workging directories or paths to GROMACS software). 

[Here](simulations/analyze.sh)
BASH script used in the analysis of the trajectories in this project. 
It is specifically written 
for the environment of the supercomputing facility *Cartesius*,
and needs to be adapted for use elsewhere. 
Commands in the script also contain explaining comments. 

To use the analysis scripts,
existing simulation(s) as described above 
need to be present. 
The analysis itself is usually done within one minute per simulation on a usual workstation. 


### Notebooks calculating membrane properties, permeability coefficients and creating plots
The **ipython notebooks calculate the membrane properties** 
including the permeability coefficients
from the files generated by the analysis scripts above. 
These notebooks can be also used stand-alone to 
access the pre-calculated values from a "CSV" dataset
and plot the results. 

The definition of the main class `Simulation` 
and its methods calculating the membrane properties 
including the permeability coefficients
are in the python script [permeana_class_simulation.py](simulations/permeana_class_simulation.py). 

The ipython notebook [analysis_martini3_simulations_make_dataFrame.ipynb](simulations/analysis_martini3_simulations_make_dataFrame.ipynb)
([here markdown version](simulations/analysis_martini3_simulations_make_dataFrame.md) of the notebook for an easy read-only access)
utilizes this python script and provides publication-ready plots from the results. 
The results can be read as inputs from the performed simulations (not provided),
or can be read as pre-calculated values used in the manuscript 
(provided as a [CSV dataset](simulations/dataFrame_all_sims.csv)).
This option can be chosen by simply skipping the cells in the notebook 
that read the raw unprocessed simulation data from disk
and executing directly the cells that load the mentioned CSV dataset. 
Rich annotations in the notebook provide guidance on how to proceed further. 

In order to use the notebooks,
several python packages need to be installed 
(see the list below). 
The notebooks do not execute computational intensive code 
and run interactively on a normal laptop. 
Example expected output 
is provided in the folder [output_figures](simulations/output_figures),
which contains "PNG" figures containing plots of the simulation data. 


## Used software 

- GROMACS 2019.6
- MDAnalysis 1.0.0
- python 3.7.8
- matplotlib 3.4.2
- seaborn 0.11.1
- numpy 1.19.2
- pandas 1.1.4

Ipython notebooks tested on Apple Macbook 
and on a GNU/Linux (Ubuntu distribution) 
with the above software from the Anaconda python distribution. 
